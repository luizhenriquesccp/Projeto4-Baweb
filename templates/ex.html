<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ exercicio.nome }} - RespiraAi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}" />
    <style>
      .circle {
        width: 180px;
        height: 180px;
        background: radial-gradient(circle, #ffeb3b 60%, #ffcb5b 100%);
        border-radius: 50%;
        margin: 0 auto 32px auto;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.5s ease-out;
      }
      
      .circle.animating {
        animation: breathing 8s ease-in-out infinite;
      }

      @keyframes breathing {
        0%   { transform: scale(1); }
        40%  { transform: scale(1.3); }
        60%  { transform: scale(1.3); }
        90%  { transform: scale(0.8); }
        100% { transform: scale(1); }
      }
      
      .tempo-total {
        font-size: 1.5em;
        color: #111;
        margin-top: 20px;
        text-align: center;
        letter-spacing: 2px;
        font-weight: bold;
      }
    </style>
</head>
<body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-light bg-warning shadow-sm py-3">
        <div class="container">
          <a class="navbar-brand fs-1 fw-normal" href="{{ url_for('index') }}" style="font-family: 'Times New Roman', Times, serif;">RespiraAi</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link fs-5 px-3" href="{{ url_for('index') }}">Exercícios</a>
              </li>
              <li class="nav-item">
                <a class="nav-link fs-5 px-3" href="{{ url_for('historico') }}">Histórico</a>
              </li>
              <li class="nav-item">
                <a class="nav-link fs-5 px-3" href="{{ url_for('index') }}#estatisticas">Estatísticas</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <main class="container my-5">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="card border-0 shadow-sm p-4 p-md-5 rounded-4 text-center" data-duracao="{{ exercicio.duracao }}" data-exercicio-id="{{ exercicio.id_exercicio }}">
            <h2 class="display-6 fw-bold mb-4">{{ exercicio.nome }}</h2>  
            
            <div class="bg-warning-subtle p-4 rounded-4 mb-4 text-start">
              {{ exercicio.descricao|safe }}
            </div>

            <div class="position-relative my-5">
              <div class="circle" id="breathCircle"></div>
            </div>

            <div class="row g-3 mb-4">
              <div class="col-6">
                <button class="btn btn-outline-dark btn-lg w-100 rounded-pill py-3 fw-bold" id="btnIniciar">INICIAR</button>
              </div>
              <div class="col-6">
                <button class="btn btn-outline-dark btn-lg w-100 rounded-pill py-3 fw-bold" id="btnPausar">PAUSAR</button>
              </div>
            </div>

            <button class="btn btn-warning btn-lg w-100 rounded-pill py-3 fw-bold mb-4 shadow-sm" id="btnTerminar">TERMINAR</button>
            
            <div class="tempo-total" id="tempoTotal">
              TEMPO TOTAL:&nbsp;&nbsp;00:00
            </div>
          </div>

          <hr class="my-5">
          
          <div class="mt-5">
            <h3 class="fw-bold mb-4">Escolha outro exercício:</h3>
            {% if exercicios %}
              <div class="row g-4">
                {% for ex in exercicios %}
                  {% set is_current = (ex.id_exercicio == exercicio.id_exercicio) %}
                  <div class="col-md-6 col-lg-4">
                    <div class="card h-100 border-2 {{ 'border-warning' if is_current else 'border-light' }} shadow-sm rounded-4">
                      <div class="card-body d-flex flex-column">
                        <h5 class="card-title fw-bold">{{ ex.nome }}</h5>
                        <p class="text-muted small mb-2">Duração: {{ ex.duracao }} min</p>
                        <p class="card-text small flex-grow-1">
                          {{ ex.descricao|truncate(60, True, '...') }}
                        </p>
                        {% if is_current %}
                          <span class="badge bg-warning text-dark mt-3 py-2">Atual</span>
                        {% else %}
                          <a href="{{ url_for('exibir_exercicio', id=ex.id_exercicio) }}" class="btn btn-outline-warning mt-3 fw-bold rounded-pill">ESCOLHER</a>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                {% endfor %}
              </div>
            {% else %}
              <div class="alert alert-light text-center">Nenhum outro exercício encontrado.</div>
            {% endif %}
          </div>
        </div>
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/ex.js') }}"></script>
</body>
</html>
